

<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
},
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="http://yihui.name/knitr"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.5</code>)
    .</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Chapter 10 Debugging Your Code NOTE : Much code is commented out, as they generate errors</span>
<span class="hl com"># on purpose. Uncomment the code and run the line to see the error and try the debugging</span>
<span class="hl com"># out Knowing What to Look For Reading Errors and Warnings Reading error messages 'a' + 1</span>
<span class="hl com"># Error in 'a' + 1 : non-numeric argument to binary operator data.frame(1:10,10:1,) Error</span>
<span class="hl com"># in data.frame(1:10, 10:1, ) : argument is missing, with no default Caring about warnings</span>
<span class="hl com"># (or not)</span>
<span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">10</span>
<span class="hl std">y</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">if</span> <span class="hl std">(x</span> <span class="hl opt">&lt;</span> <span class="hl num">5</span><span class="hl std">)</span> <span class="hl num">0</span> <span class="hl kwa">else</span> <span class="hl num">1</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: the condition has length > 1 and only the first element will be used
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl num">4</span>
<span class="hl kwd">sqrt</span><span class="hl std">(x</span> <span class="hl opt">-</span> <span class="hl num">5</span><span class="hl std">)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: NaNs produced
</pre></div>
<div class="output"><pre class="knitr r">## [1] NaN
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">plot</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">10</span><span class="hl std">,</span> <span class="hl num">10</span><span class="hl opt">:</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">color</span> <span class="hl std">=</span> <span class="hl str">&quot;green&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: "color" is not a graphical parameter
## Warning: "color" is not a graphical parameter
## Warning: "color" is not a graphical parameter
## Warning: "color" is not a graphical parameter
## Warning: "color" is not a graphical parameter
## Warning: "color" is not a graphical parameter
</pre></div>
</div><div class="rimage center"><img src="figure/ch10-Rhtmlunnamed-chunk-1.png" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Going Bug Hunting Calculating the logit checks input and does logit calculation</span>
<span class="hl std">logit</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span>
    <span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ifelse</span><span class="hl std">(x</span> <span class="hl opt">&lt;</span> <span class="hl num">0</span> <span class="hl opt">|</span> <span class="hl std">x</span> <span class="hl opt">&gt;</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;NA&quot;</span><span class="hl std">, x)</span>
    <span class="hl kwd">log</span><span class="hl std">(x</span><span class="hl opt">/</span><span class="hl std">(</span><span class="hl num">1</span> <span class="hl opt">-</span> <span class="hl std">x))</span>
<span class="hl std">}</span>
<span class="hl com"># transforms percentage to number and calls logit</span>
<span class="hl std">logitpercent</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span>
    <span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">gsub</span><span class="hl std">(</span><span class="hl str">&quot;%&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;&quot;</span><span class="hl std">, x)</span>
    <span class="hl kwd">logit</span><span class="hl std">(</span><span class="hl kwd">as.numeric</span><span class="hl std">(x))</span>
<span class="hl std">}</span>
<span class="hl com">## Knowing where an error comes from logitpercent('50%') Error in 1 - x : non-numeric</span>
<span class="hl com">## argument to binary operator traceback() Looking inside a function Telling R which</span>
<span class="hl com">## function to debug debug(logit) logitpercent('50%') Stepping through the function Start</span>
<span class="hl com">## browsing from within the function</span>
<span class="hl std">logit</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span>
    <span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ifelse</span><span class="hl std">(x</span> <span class="hl opt">&lt;</span> <span class="hl num">0</span> <span class="hl opt">|</span> <span class="hl std">x</span> <span class="hl opt">&gt;</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;NA&quot;</span><span class="hl std">, x)</span>
    <span class="hl kwd">browser</span><span class="hl std">()</span>
    <span class="hl kwd">log</span><span class="hl std">(x</span><span class="hl opt">/</span><span class="hl std">(</span><span class="hl num">1</span> <span class="hl opt">-</span> <span class="hl std">x))</span>
<span class="hl std">}</span>
<span class="hl com"># logit(50) Generating Your Own Messages Creating errors</span>
<span class="hl std">logit</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span>
    <span class="hl kwa">if</span> <span class="hl std">(</span><span class="hl kwd">any</span><span class="hl std">(x</span> <span class="hl opt">&lt;</span> <span class="hl num">0</span> <span class="hl opt">|</span> <span class="hl std">x</span> <span class="hl opt">&gt;</span> <span class="hl num">1</span><span class="hl std">))</span>
        <span class="hl kwd">stop</span><span class="hl std">(</span><span class="hl str">&quot;x not between 0 and 1&quot;</span><span class="hl std">)</span>
    <span class="hl kwd">log</span><span class="hl std">(x</span><span class="hl opt">/</span><span class="hl std">(</span><span class="hl num">1</span> <span class="hl opt">-</span> <span class="hl std">x))</span>
<span class="hl std">}</span>
<span class="hl com"># logitpercent(c('50%','150%')) Error in logit(as.numeric(x)/100) : x not between 0 and 1</span>
<span class="hl com"># Creating warnings Function wrapped around for illustrative purposes In book only body is</span>
<span class="hl com"># given</span>
<span class="hl std">logit</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span>
    <span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ifelse</span><span class="hl std">(x</span> <span class="hl opt">&lt;</span> <span class="hl num">0</span> <span class="hl opt">|</span> <span class="hl std">x</span> <span class="hl opt">&gt;</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl num">NA</span><span class="hl std">, x)</span>
    <span class="hl kwa">if</span> <span class="hl std">(</span><span class="hl kwd">any</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(x)))</span>
        <span class="hl kwd">warning</span><span class="hl std">(</span><span class="hl str">&quot;x not between 0 and 1&quot;</span><span class="hl std">)</span>
    <span class="hl kwd">log</span><span class="hl std">(x</span><span class="hl opt">/</span><span class="hl std">(</span><span class="hl num">1</span> <span class="hl opt">-</span> <span class="hl std">x))</span>
<span class="hl std">}</span>
<span class="hl kwd">logitpercent</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;50%&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;150%&quot;</span><span class="hl std">))</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: x not between 0 and 1
</pre></div>
<div class="output"><pre class="knitr r">## [1] NA NA
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Recognizing the Mistakes You're Sure to Make Starting with the wrong data Having your</span>
<span class="hl com"># data in the wrong format Dropping dimensions when you don’t expect it</span>
<span class="hl std">rowsum.df</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span>
    <span class="hl std">id</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sapply</span><span class="hl std">(x, is.numeric)</span>
    <span class="hl kwd">rowSums</span><span class="hl std">(x[, id])</span>
<span class="hl std">}</span>
<span class="hl com"># rowsum.df(sleep) Messing up with lists</span>
<span class="hl kwd">strsplit</span><span class="hl std">(</span><span class="hl str">&quot;this is a sentence&quot;</span><span class="hl std">,</span> <span class="hl str">&quot; &quot;</span><span class="hl std">)[</span><span class="hl num">2</span><span class="hl std">]</span>
</pre></div>
<div class="output"><pre class="knitr r">## [[1]]
## NULL
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">strsplit</span><span class="hl std">(</span><span class="hl str">&quot;this is a sentence&quot;</span><span class="hl std">,</span> <span class="hl str">&quot; &quot;</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [[1]]
## [1] "this"     "is"       "a"        "sentence"
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">strsplit</span><span class="hl std">(</span><span class="hl str">&quot;this is a sentence&quot;</span><span class="hl std">,</span> <span class="hl str">&quot; &quot;</span><span class="hl std">)[[</span><span class="hl num">1</span><span class="hl std">]][</span><span class="hl num">2</span><span class="hl std">]</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] "is"
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">customer</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Johan Delong&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Marie Petit&quot;</span><span class="hl std">)</span>
<span class="hl std">namesplit</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">strsplit</span><span class="hl std">(customer,</span> <span class="hl str">&quot; &quot;</span><span class="hl std">)</span>
<span class="hl kwd">paste</span><span class="hl std">(namesplit[</span><span class="hl num">2</span><span class="hl std">],</span> <span class="hl kwc">collapse</span> <span class="hl std">=</span> <span class="hl str">&quot;.&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] "c(\"Marie\", \"Petit\")"
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">paste</span><span class="hl std">(namesplit[[</span><span class="hl num">2</span><span class="hl std">]],</span> <span class="hl kwc">collapse</span> <span class="hl std">=</span> <span class="hl str">&quot;.&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] "Marie.Petit"
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">### Mixing up factors and numeric vectors</span>
<span class="hl std">cyl.factor</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.factor</span><span class="hl std">(mtcars</span><span class="hl opt">$</span><span class="hl std">cyl)</span>
<span class="hl kwd">median</span><span class="hl std">(</span><span class="hl kwd">as.numeric</span><span class="hl std">(cyl.factor))</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 2
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">as.numeric</span><span class="hl std">(</span><span class="hl kwd">levels</span><span class="hl std">(cyl.factor))[cyl.factor]</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4
</pre></div>
</div></div>


  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 3.0.2 (2013-09-25)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## 
## locale:
## [1] LC_COLLATE=English_United Kingdom.1252  LC_CTYPE=English_United Kingdom.1252   
## [3] LC_MONETARY=English_United Kingdom.1252 LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] BiocInstaller_1.12.1 ggplot2_0.9.3.1      reshape2_1.2.2       sos_1.3-8           
##  [5] brew_1.0-6           stringr_0.6.2        knitr_1.5            plyr_1.8            
##  [9] Revobase_7.1.0       RevoMods_7.1.0       RevoScaleR_7.1.0     lattice_0.20-27     
## [13] rpart_4.1-2         
## 
## loaded via a namespace (and not attached):
##  [1] codetools_0.2-8    colorspace_1.2-4   dichromat_2.0-0    digest_0.6.4      
##  [5] evaluate_0.5.1     foreach_1.4.1      formatR_0.10       fortunes_1.5-2    
##  [9] grid_3.0.2         gtable_0.1.2       highr_0.3          iterators_1.0.6   
## [13] labeling_0.2       MASS_7.3-29        munsell_0.4.2      proto_0.3-10      
## [17] RColorBrewer_1.0-5 scales_0.2.3       tools_3.0.2
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] "2014-05-13 15:05:46 BST"
</pre></div>
</div></div>




</body>
</html>
